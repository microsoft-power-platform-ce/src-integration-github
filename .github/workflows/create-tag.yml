name: Create Tag

on:
  push:
    branches: [main]

concurrency: create-tag

jobs:
  create-tag:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - id: get-solution-version
        uses: microsoft-power-platform-ce/actions/get-solution-version@main
      - id: check-for-new-version
        run: |
          Write-Host "::set-output name=is-new-version::$(-Not $(git tag).Contains("v${{ steps.get-solution-version.outputs.solution-version }}")"
        shell: pwsh
      - if: steps.check-for-new-version.outputs.is-new-version == True
        name: Create Tag
        run: |
          Write-Host "creating new tag v${{ steps.get-solution-version.outputs.solution-version }}"
